<!DOCTYPE html><html lang="en"><head><title>www/coffee/calculator</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../"><meta name="groc-document-path" content="www/coffee/calculator"><meta name="groc-project-path" content="www/coffee/calculator.coffee"><link rel="stylesheet" type="text/css" media="all" href="../../assets/style.css"><script type="text/javascript" src="../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">www/coffee/calculator.coffee</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h3 id="calculator-for-loan-money">Calculator for Loan Money</h3></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="code-html-of-the-form-for-the-simulator-in-jquery-mobile">Code HTML of the form for the simulator in jQuery Mobile</h5></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="delegateeventforpagesimulator">Delegate event for page <code>simulator</code></h5>

<p>Delegate event to load the DOM for the id page <code>simulator</code> with <code>pageinit</code></p></div></div><div class="code"><div class="wrapper"><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span> <span class="s">&#39;pageinit&#39;</span><span class="p">,</span> <span class="s">&#39;#simulator&#39;</span><span class="p">,</span> <span class="nf">(event)-&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><pre><code class=" html">&lt;form&gt;
  &lt;!-- test comment --&gt;
  &lt;input type="number" id="txt-amount" pattern="[0-9]*" placeholder="Digite el monto"&gt;
  &lt;input type="number" id="txt-interestRate" placeholder="Digite tasa de interés (x.x%)"&gt;
  &lt;input type="number" id="txt-feeNumber" pattern="[0-9]*" placeholder="Digite N° de cuotas pactadas"&gt;
  &lt;button id="btnCalculateCredit" class="ui-btn ui-btn-b"&gt;Calcular&lt;/button&gt;
  &lt;label id="txt-feeToPay"&gt;Cuota a Pagar:&lt;/label&gt;
  &lt;label id="txt-totalPay"&gt;Valor Total Pagado:&lt;/label&gt;
  &lt;label id="txt-totalInterest"&gt;Total Interés Pagado:&lt;/label&gt;
  &lt;button class="ui-btn ui-btn-b" id="btnResetSimulatorFields"&gt;Nuevo&lt;/button&gt;
&lt;/form&gt;
</code></pre></div></div><div class="code"><div class="wrapper">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;ready for simulator&#39;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h4 id="functions">Functions</h4></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="functioncalculatecredit">Function <code>calculateCredit</code></h5>

<p>Function to calculate the loan amount according to the form in HTML</p></div></div><div class="code"><div class="wrapper">  <span class="nv">calculateCredit = </span><span class="nf">-&gt;</span>
    <span class="nv">amount = </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#txt-amount&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
    <span class="nv">interestRate = </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#txt-interestRate&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
    <span class="nv">feeNumber = </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#txt-feeNumber&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
    <span class="nv">tmp = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="nx">interestRate</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)),</span> <span class="p">(</span><span class="o">-</span><span class="nx">feeNumber</span><span class="p">))</span>
    <span class="nv">tmpd = </span><span class="mi">1</span> <span class="o">-</span> <span class="nx">tmp</span>
    <span class="nv">tmpn = </span><span class="nx">amount</span> <span class="o">*</span> <span class="p">(</span><span class="nx">interestRate</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
    <span class="nv">feeToPay = </span><span class="nx">round</span><span class="p">(</span><span class="nx">tmpn</span> <span class="o">/</span> <span class="nx">tmpd</span><span class="p">)</span>
    <span class="nv">totalPay = </span><span class="nx">round</span><span class="p">(</span><span class="nx">feeToPay</span> <span class="o">*</span> <span class="nx">feeNumber</span><span class="p">)</span>
    <span class="nv">totalInterest = </span><span class="nx">round</span><span class="p">(</span><span class="nx">totalPay</span> <span class="o">-</span> <span class="nx">amount</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#resultsCalculateCredit&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="s">&#39;&lt;label id=&quot;txt-feeToPay&quot;&gt;Cuota a Pagar:&lt;strong class=&quot;simulator&quot;&gt;&#39;</span> <span class="o">+</span> <span class="s">&#39; $ &#39;</span> <span class="o">+</span> <span class="nx">feeToPay</span> <span class="o">+</span> <span class="s">&#39;&lt;/strong&gt;&lt;/label&gt;&#39;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#resultsCalculateCredit&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="s">&#39;&lt;label id=&quot;txt-totalPay&quot;&gt;Valor Total Pagado:&lt;strong class=&quot;simulator&quot;&gt;&#39;</span> <span class="o">+</span> <span class="s">&#39; $ &#39;</span> <span class="o">+</span> <span class="nx">totalPay</span> <span class="o">+</span> <span class="s">&#39;&lt;/strong&gt;&lt;/label&gt;&#39;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#resultsCalculateCredit&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="s">&#39;&lt;label id=&quot;txt-totalInterest&quot;&gt;Total Interés Pagado:&lt;strong class=&quot;simulator&quot;&gt;&#39;</span> <span class="o">+</span> <span class="s">&#39; $ &#39;</span> <span class="o">+</span> <span class="nx">totalInterest</span> <span class="o">+</span> <span class="s">&#39;&lt;/strong&gt;&lt;/label&gt;&#39;</span>
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="functionround">Function <code>round</code></h5>

<p>supplementing function <code>calculateCredit</code> to round values ​​in JS</p></div></div><div class="code"><div class="wrapper">  <span class="nv">round = </span><span class="nf">(val) -&gt;</span>
    <span class="nv">tmp = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">val</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">+</span> <span class="s">&quot;&quot;</span>
    <span class="k">if</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)</span> <span class="o">is</span> <span class="o">-</span><span class="mi">1</span>
      <span class="nx">tmp</span> <span class="o">+=</span> <span class="s">&quot;.00&quot;</span>
    <span class="k">else</span> <span class="nx">tmp</span> <span class="o">+=</span> <span class="s">&quot;0&quot;</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">tmp</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)</span> <span class="o">is</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nx">tmp</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="functioncleardata">Function <code>clearData</code></h5>

<p>Function to clean result fields of the form</p></div></div><div class="code"><div class="wrapper">  <span class="nv">clearData = </span><span class="nf">-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#txt-amount&#39;</span><span class="p">).</span><span class="nx">val</span> <span class="s">&quot;&quot;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#txt-interestRate&#39;</span><span class="p">).</span><span class="nx">val</span> <span class="s">&quot;&quot;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#txt-feeNumber&#39;</span><span class="p">).</span><span class="nx">val</span> <span class="s">&quot;&quot;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#txt-feeToPay&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#txt-totalPay&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>
    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#txt-totalInterest&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h4 id="events">Events</h4>

<p>Listen Events with jQuery</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h4 id="eventbtncalculatecredit">Event <code>#btnCalculateCredit</code></h4>

<p>Event <code>#btnCalculateCredit</code> to calculate loan with <code>calculateCredit</code></p></div></div><div class="code"><div class="wrapper">  <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#btnCalculateCredit&#39;</span><span class="p">).</span><span class="nx">on</span> <span class="s">&#39;click&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;click on calculateCredit&#39;</span>
    <span class="nx">calculateCredit</span><span class="p">()</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h4 id="eventbtnresetsimulatorfields">Event <code>#btnResetSimulatorFields</code></h4>

<p>Event <code>#btnResetSimulatorFields</code> reset fields and clean info with <code>calculateCredit</code></p></div></div><div class="code"><div class="wrapper">  <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#btnResetSimulatorFields&#39;</span><span class="p">).</span><span class="nx">on</span> <span class="s">&#39;click&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;click on btnResetSimulatorFields&#39;</span>
    <span class="nx">clearData</span><span class="p">()</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span></div></div></div></div></body></html>